<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Planilha Excel - Transporte e Estoque</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- SheetJS (xlsx) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- main.css -->
    <link rel="stylesheet" href="main.css">

</head>
<body>
    <div class="container-fluid">
        <div class="text-center mb-4">
            <h1 class="header-title display-5 fw-bold">Gerador de Planilha Excel - Transporte e Estoque</h1>
            <p class="text-white lead">Sistema completo para gerenciamento de transporte, logística e controle de estoque com validade</p>
        </div>

        <!-- Alerta de produto não encontrado -->
        <div id="produtoNaoEncontradoAlert" class="alert alert-warning-custom">
            <strong>⚠️ Atenção!</strong> Produto <span id="produtoAlerta"></span> (Lote: <span id="loteAlerta"></span>) do cliente <span id="clienteAlerta"></span> não encontrado no estoque. Verifique antes de registrar a saída!
        </div>

        <ul class="nav nav-tabs justify-content-center mb-3" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="movimentacao-tab" data-bs-toggle="tab" data-bs-target="#movimentacao" type="button" role="tab">Movimentação</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="estoque-tab" data-bs-toggle="tab" data-bs-target="#estoque" type="button" role="tab">Estoque</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Movimentação Tab -->
            <div class="tab-pane fade show active" id="movimentacao" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body p-3 p-md-4">
                                <form id="dataForm">
                                    <div class="row g-2 g-md-3">
                                        <!-- Primeira linha -->
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="dataMovimentacao" class="form-label">DATA MOVIMENTAÇÃO</label>
                                            <input type="date" class="form-control" id="dataMovimentacao" required>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="tipoMovimentacao" class="form-label">TIPO</label>
                                            <select class="form-control" id="tipoMovimentacao" required>
                                                <option value="">Selecione...</option>
                                                <option value="entrada">Entrada</option>
                                                <option value="saida">Saída</option>
                                            </select>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="cte" class="form-label">CT-e</label>
                                            <input type="text" class="form-control" id="cte" placeholder="Conhecimento">
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="nf" class="form-label">NF</label>
                                            <input type="text" class="form-control" id="nf" placeholder="Nota Fiscal" required>
                                        </div>
                                        
                                        <!-- Segunda linha -->
                                        <div class="col-12 col-md-6">
                                            <label for="cliente" class="form-label">CLIENTE/FORNECEDOR</label>
                                            <input type="text" class="form-control" id="cliente" placeholder="Nome" required>
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <label for="motorista" class="form-label">MOTORISTA</label>
                                            <input type="text" class="form-control" id="motorista" placeholder="Motorista">
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="valorNf" class="form-label">VALOR NF (R$)</label>
                                            <input type="number" class="form-control currency-input" id="valorNf" placeholder="0.00" min="0" step="0.01">
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-3">
                                            <label for="destino" class="form-label">DESTINO/LOCAL</label>
                                            <input type="text" class="form-control" id="destino" placeholder="Local" required>
                                        </div>
                                        
                                        <!-- Produtos Section -->
                                        <div class="col-12">
                                            <label class="form-label">Produtos</label>
                                            <div id="produtosContainer">
                                                <!-- Produtos serão adicionados aqui -->
                                            </div>
                                            <button type="button" id="addProdutoBtn" class="btn btn-success add-produto-btn">Adicionar Produto</button>
                                        </div>
                                        
                                        <!-- Observações -->
                                        <div class="col-12">
                                            <label for="observacoes" class="form-label">OBSERVAÇÕES</label>
                                            <textarea class="form-control" id="observacoes" rows="2" placeholder="Observações"></textarea>
                                        </div>
                                        
                                        <div class="col-12 text-center">
                                            <button type="submit" class="btn btn-primary mt-3">Adicionar à Lista</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Filtro Section -->
                        <div class="filter-section mt-3">
                            <div class="row g-2">
                                <div class="col-12 col-md-4 col-lg-2">
                                    <label class="form-label">NF</label>
                                    <input type="text" class="form-control" id="filterNf" placeholder="Nota Fiscal">
                                </div>
                                <div class="col-12 col-md-4 col-lg-2">
                                    <label class="form-label">Período</label>
                                    <div class="date-range-filter">
                                        <div>
                                            <input type="date" class="form-control" id="filterDataInicio" placeholder="Data Início">
                                        </div>
                                        <div>
                                            <input type="date" class="form-control" id="filterDataFim" placeholder="Data Fim">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4 col-lg-2">
                                    <label class="form-label">Cliente</label>
                                    <input type="text" class="form-control" id="filterCliente" placeholder="Cliente">
                                </div>
                                <div class="col-12 col-md-4 col-lg-2">
                                    <label class="form-label">Produto</label>
                                    <input type="text" class="form-control" id="filterProduto" placeholder="Produto">
                                </div>
                                <div class="col-12 col-md-4 col-lg-2">
                                    <label class="form-label">Tipo</label>
                                    <select class="form-control" id="filterTipo">
                                        <option value="">Todos</option>
                                        <option value="entrada">Entrada</option>
                                        <option value="saida">Saída</option>
                                    </select>
                                </div>
                                <div class="col-12 col-md-12 col-lg-2">
                                    <div class="d-flex gap-2 mt-2">
                                        <button id="applyFilter" class="btn btn-primary w-100">Filtrar</button>
                                        <button id="clearFilter" class="btn clear-filters">Limpar</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="table-container">
                            <div class="card mt-3">
                                <div class="card-body p-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h6 class="mb-0">Movimentações Cadastradas</h6>
                                        <button id="exportBtn" class="btn btn-success btn-sm">Exportar Excel</button>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-striped mb-0">
                                            <thead>
                                                <tr>
                                                    <th>DATA</th>
                                                    <th>TIPO</th>
                                                    <th>NF</th>
                                                    <th>CLIENTE</th>
                                                    <th>PRODUTOS</th>
                                                    <th>TOTAL QTDE</th>
                                                    <th>OBSERVAÇÕES</th>
                                                    <th>AÇÕES</th>
                                                </tr>
                                            </thead>
                                            <tbody id="dataTableBody">
                                                <!-- Dados serão adicionados aqui -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Estoque Tab -->
            <div class="tab-pane fade" id="estoque" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <!-- Formulário de Adição/Editação de Estoque -->
                        <div class="estoque-form">
                            <h5 class="estoque-form-title">Adicionar/Editar Produto no Estoque</h5>
                            <form id="estoqueForm">
                                <div class="row g-2">
                                    <div class="col-12 col-md-4">
                                        <label for="estoqueCliente" class="form-label">CLIENTE *</label>
                                        <input type="text" class="form-control" id="estoqueCliente" placeholder="Nome do Cliente" required>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <label for="estoqueProduto" class="form-label">PRODUTO *</label>
                                        <input type="text" class="form-control" id="estoqueProduto" placeholder="Nome do Produto" required>
                                    </div>
                                    <div class="col-12 col-md-2">
                                        <label for="estoqueLote" class="form-label">LOTE *</label>
                                        <input type="text" class="form-control" id="estoqueLote" placeholder="Lote" required>
                                    </div>
                                    <div class="col-12 col-md-2">
                                        <label for="estoqueQuantidade" class="form-label">QUANTIDADE *</label>
                                        <input type="number" class="form-control" id="estoqueQuantidade" placeholder="0" min="1" required>
                                    </div>
                                    <div class="col-12 col-md-2">
                                        <label for="estoqueFabricacao" class="form-label">FABRICAÇÃO *</label>
                                        <input type="date" class="form-control" id="estoqueFabricacao" required>
                                    </div>
                                    <div class="col-12 col-md-2">
                                        <label for="estoqueVencimento" class="form-label">VENCIMENTO *</label>
                                        <input type="date" class="form-control" id="estoqueVencimento" required>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="submit" class="btn btn-info">Adicionar/Atualizar Produto</button>
                                        <button type="button" id="cancelarEdicao" class="btn btn-secondary" style="display:none;">Cancelar</button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Estoque Geral -->
                        <div class="estoque-geral-header">
                            <h5 class="mb-0">Estoque Geral (Todos os Clientes)</h5>
                        </div>
                        <div class="card">
                            <div class="card-body p-3">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <h6 class="mb-0">Resumo do Estoque Geral</h6>
                                    <button id="exportEstoqueGeralBtn" class="btn btn-warning btn-sm">Exportar Estoque Geral</button>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped mb-0">
                                        <thead>
                                            <tr>
                                                <th>PRODUTO</th>
                                                <th>LOTE TOTAL</th>
                                                <th>QUANTIDADE TOTAL</th>
                                                <th>STATUS MÉDIO</th>
                                            </tr>
                                        </thead>
                                        <tbody id="estoqueGeralTableBody">
                                            <!-- Dados de estoque geral serão adicionados aqui -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="alert alert-info mt-2 p-2 text-center" id="estoqueGeralInfo">
                                    Nenhum produto em estoque geral cadastrado.
                                </div>
                            </div>
                        </div>

                        <!-- Estoque por Cliente -->
                        <div class="estoque-cliente-header">
                            <h5 class="mb-0">Estoque por Cliente</h5>
                        </div>
                        
                        <!-- Tabs de Clientes -->
                        <ul class="nav nav-pills mb-3" id="clienteTabs" role="tablist">
                            <!-- Clientes serão adicionados dinamicamente aqui -->
                        </ul>
                        
                        <div class="tab-content" id="clienteTabContent">
                            <!-- Conteúdo dos clientes será adicionado dinamicamente aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- main.js -->
    <script src="main.js"></script>
</body>
</html>

